"use client";

import { useRef, useState } from "react";
import { gsap } from "gsap";
import { MorphSVGPlugin } from "gsap-trial/MorphSVGPlugin";
import { useGSAP } from "@gsap/react";

const CLOSED_LID =
  "M1036.74,348.47c-10.19,17.48-22.34,29.6-32.08,45.08-8.87,15.91-22.11,29.65-37.52,40.54-11.66,10.45-29.3,24.24-42.16,35.86-12.94,8.45-29.71,20.54-45.98,31.04-20.03,10.72-41.36,22.7-65.29,31.88-23.94,7.84-44.2,11.6-67.69,19.76-23.85,6.97-46.4,9.32-68.85,7.98-19.61-1.18-44.74-3.15-68.75-3.47-24.85-5.47-46.1-7-67.47-14.27-24.59-4.56-42.64-17.74-64.75-25.66-22.15-14.2-43.79-19.09-61.52-36.08-17.62-14.05-34.99-23.17-55.33-45.59-10.19-13.26-27.41-24.32-37.77-40.16-12.18-14.2-23.35-24.68-32.17-44.71-4.32-4.46,5.36-10.27,8.68-6.22,11.81,14.86,30.25,25.26,38.29,36.49,24.11,19.45,43.38,37.59,65.16,50.4,19.95,13.76,44.31,26.82,67.1,37.73,17.67,11.21,50.1,18.16,70.39,26.54,23.04,4.48,47.44,13.57,67.87,14.85,24.81,3.53,43.46.99,69.88,3.38,22.59,1.19,46.9-2.64,69.57-8.05,28.5-9.59,63.6-10.27,91.23-28.35,17.22-9.42,27.9-19.31,44.3-22.38,13.54-6.75,29.64-15.26,43.87-25.93,13.7-12.39,30.34-18.72,42.49-31.57,15.4-10.38,27.53-24.23,41.19-36.48,3.02-6.18,13.74-11.91,18.73-18.93.08,1.03,6.09-4.2,7.58-.25,1.8,3.83,3.39,2.67.99,6.58-1.53-2.91,1.2-1.07,0,0Z";

const OPEN_LID =
  "M1028.39,348.93c-23.51-18.33-49.22-32.07-72.82-51.31-24.08-15.59-52.37-26.97-77.72-39.17-23.71-10.65-55.03-18.79-81.34-26.77-28.43-6.34-53.87-14.28-83.68-14.09-27.16-5.32-55.4-1.93-84.14-.07-20.95.85-52.46,2.67-85.13,11.01-29.33.41-58.7,13.07-83.65,25.85-29.31,9.85-53.25,24.47-79.62,39.07-10.32,4.6-30.17,19.33-42.63,27.05-12.98,6.85-28.34,22.59-40.05,30.73-.41,4.38-6.79,2.57-7.56-.58-1.69-4.67-2.96-4.55-.29-6.61,8.68-13.39,22.59-28.72,34.85-39.53,11.98-17.91,23.87-26.07,39.87-34.52,21.13-15.94,46.15-28.81,67.97-44.54,24.9-13.91,51.05-21.35,73.78-31.26,28.55-6.66,49.44-19.31,76.13-19.01,24.76-3.06,52.98-6.45,80.11-6.43,33.03,3.07,52.42,2.02,79.08,6.12,26.69,2.1,53.48,11.39,77.33,18.65,29.1,9.67,51.04,16.78,73.79,31.17,26.27,12.85,48.96,26.69,68.46,43.66,13.23,9.61,30.94,22.85,40.13,34.23,12.26,11.19,26.74,26.7,35.14,39.28,5.07,3.85-2.45,11.27-7.99,7.09.03-.03,1.13.98,0,0Z";

const OPEN_CLIP =
  "M293.77,347.55s136.19-155.72,369.31-155.72,369.31,153.55,369.31,153.55v373.85H293.77v-371.68Z";
const CLOSED_CLIP =
  "M293.77,347.55s136.19,194.1,369.31,194.1,369.31-196.27,369.31-196.27v373.85H293.77v-371.68Z";

const Eye = () => {
  gsap.registerPlugin(MorphSVGPlugin);

  const ref = useRef(null);
  const eyeRef = useRef(null);
  const clipRef = useRef(null);
  const [isOpen, setIsOpen] = useState(false);
  const { contextSafe } = useGSAP({ scope: ref });
  const openEye = contextSafe(() => {
    setIsOpen(true);
    gsap.to(eyeRef.current, { morphSVG: OPEN_LID });
    gsap.to(clipRef.current, { morphSVG: OPEN_CLIP });
  });

  const closeEye = contextSafe(() => {
    setIsOpen(false);
    gsap.to(eyeRef.current, { morphSVG: CLOSED_LID });
    gsap.to(clipRef.current, { morphSVG: CLOSED_CLIP });
  });

  return (
    <div>
      <svg
        onClick={() => {
          console.log("clicked");
          if (isOpen) closeEye();
          else openEye();
        }}
        ref={ref}
        className="absolute top-0 left-0 w-screen h-screen p-60 pb-120 fill-BEIGE"
        viewBox="0 0 1356.03 696.86"
      >
        <clipPath id="clippath">
          <path ref={clipRef} className="fill-RED" d={CLOSED_CLIP} />
        </clipPath>
        <clipPath id="clippath-1">
          <path
            className="fill-none"
            d="M293.79,351.81s136.34-155.89,369.71-155.89,369.71,153.71,369.71,153.71v374.26H293.79v-372.08Z"
          />
        </clipPath>

        <g id="eye-2">
          <g id="closed">
            <g clipPath="url(#clippath)">
              <g>
                <circle
                  className="fill-RED"
                  cx="668.3"
                  cy="349.63"
                  r="185.79"
                />
                <circle
                  className="fill-GREEN"
                  cx="667.64"
                  cy="348.96"
                  r="59.48"
                />
              </g>
            </g>
            <path ref={eyeRef} d={CLOSED_LID} />
          </g>
          {/* <g id="open">
            <g clipPath="url(#clippath-1)">
              <g>
                <circle
                  className="fill-RED"
                  cx="668.3"
                  cy="349.63"
                  r="185.79"
                />
                <circle
                  className="fill-GREEN"
                  cx="667.64"
                  cy="348.96"
                  r="59.48"
                />
              </g>
            </g>
            <path d="M1037.21,346.09c-10-11.77-23.57-28.16-35.18-39.33-14.09-11.91-25.97-24.47-40.17-34.26-14.77-12-29.72-20.32-43.85-29.79-15.28-8.31-30.65-17.2-46.73-24.75-12.86-5.44-32.72-14.98-48.11-19.4-17.8-5.98-35.13-10.1-50.63-13.83-18.52-3.31-34.31-4.39-51.18-7.91-15.43.02-34.93-3.91-51.72-3.97-.41-.55-.18-42.43,0-41.08,1.64-.21-10.62,3.08-13.37,0-1.7-.77.36,39.75,0,41.11-19.49.8-31.77,1.88-52.02,3.21-17.47,2.7-33.94,4.02-50.86,9.07-17.79,1.28-34.33,8.48-50.18,13.45-16.13,6.17-31.19,11.36-48.39,20.29-18.19,6.75-31.84,16.81-46.52,25.38-14.94,10.96-28.91,18.84-43.74,29.88-13.63,10.46-27.71,23.9-39.92,34.56-14.17,12.05-25.49,23.46-34.89,39.57-1.64,1.81-1.1,4.81.29,6.61,1.17,2.06,6.06,3.37,7.57.58,13.36-10.43,26.49-20.32,40.1-30.77,16.55-10.18,27.8-18.89,42.68-27.08,25.88-15.3,52.69-29.08,79.61-39.42,27.34-10.6,55.01-17.81,83.84-25.56,28.38-6.8,58.19-10.76,85.2-11.12,27.23-3.14,58.78-3.36,84.25.17,29.82,3.73,56.33,7.52,83.59,13.18,27.57,6.31,53.37,16.23,81.61,27.72,27.76,10.42,53.68,22.62,77.8,39.22,23.01,13.2,47.4,31.25,72.9,51.36,5.6,4.9,10.96-.57,8-7.1Z" />
          </g> */}
        </g>
      </svg>
    </div>
  );
};

export default Eye;
